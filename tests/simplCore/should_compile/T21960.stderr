
==================== Tidy Core ====================
Result size of Tidy Core
  = {terms: 1,176, types: 773, coercions: 114, joins: 25/45}

-- RHS size: {terms: 1,161,
              types: 764,
              coercions: 114,
              joins: 25/45}
encodeUtf8BuilderEscaped [InlPrag=INLINE (sat-args=1)]
  :: BP.BoundedPrim Word8 -> Text -> B.Builder
[GblId,
 Arity=5,
 Str=<M!P(L,LC(S,C(1,C(1,!P(L,1L)))))><1!P(L,L,L)><1C(L,C(1,L))><1L><L>,
 Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True,
         Guidance=ALWAYS_IF(arity=1,unsat_ok=False,boring_ok=False)
         Tmpl= (\ (be_a1kE :: BP.BoundedPrim Word8)
                  (eta_B0 [Occ=Once1!] :: Text)
                  (@r_a238)
                  (eta1_B1 [Occ=Once1] :: B.BuildStep r_a238)
                  (eta2_B2 [Occ=Once1] :: B.BufferRange)
                  (eta3_B3 [Occ=Once1, OS=OneShot]
                     :: GHC.Prim.State# GHC.Prim.RealWorld) ->
                  let {
                    bound_a1kF :: Int
                    [LclId]
                    bound_a1kF
                      = case be_a1kE of
                        { Data.ByteString.Builder.Prim.Internal.BP bx_a27M _ [Occ=Dead] ->
                        case GHC.Prim.<=# 4# bx_a27M of {
                          __DEFAULT -> GHC.Types.I# 4#;
                          1# -> GHC.Types.I# bx_a27M
                        }
                        } } in
                  case eta_B0 of
                  { Text bx_d22M [Occ=OnceL1] bx1_d22N bx2_d22O [Occ=Once1] ->
                  case eta1_B1 of k_X2 [Occ=OnceL1!] { __DEFAULT ->
                  let {
                    iend_s26Z :: GHC.Prim.Int#
                    [LclId]
                    iend_s26Z = GHC.Prim.+# bx1_d22N bx2_d22O } in
                  let {
                    iend1_a1wD [Occ=OnceL1] :: Int
                    [LclId, Unf=OtherCon []]
                    iend1_a1wD = GHC.Types.I# iend_s26Z } in
                  letrec {
                    outerLoop_a1TC [Occ=LoopBreaker]
                      :: Int -> B.BufferRange -> IO (B.BuildSignal r_a238)
                    [LclId, Arity=3, Unf=OtherCon []]
                    outerLoop_a1TC
                      = \ (i0_a1z3 [Occ=Once1!] :: Int)
                          (br_a1z4 [Occ=Once1!] :: B.BufferRange) ->
                          case i0_a1z3 of i1_X3 { GHC.Types.I# ipv_s270 ->
                          case br_a1z4 of wild1_X4 [Occ=Once1]
                          { B.BufferRange bx3_d22P bx4_d22Q ->
                          let {
                            ope_a1z6 [Occ=OnceL1] :: Ptr Word8
                            [LclId, Unf=OtherCon []]
                            ope_a1z6 = GHC.Ptr.Ptr @Word8 bx4_d22Q } in
                          let {
                            outRemaining_a1z7 :: Int
                            [LclId]
                            outRemaining_a1z7
                              = let {
                                  a_s272 :: GHC.Prim.Int#
                                  [LclId]
                                  a_s272 = GHC.Prim.minusAddr# bx4_d22Q bx3_d22P } in
                                case GHC.Classes.eqInt bound_a1kF (GHC.Types.I# 0#) of {
                                  False ->
                                    join {
                                      $j_a23n [Occ=Once2T[0]] :: Int
                                      [LclId[JoinId(0)(Nothing)]]
                                      $j_a23n
                                        = case bound_a1kF of { GHC.Types.I# y_a23P [Occ=Once1] ->
                                          case GHC.Prim.quotInt# a_s272 y_a23P
                                          of ds2_a23R [Occ=Once1]
                                          { __DEFAULT ->
                                          GHC.Types.I# ds2_a23R
                                          }
                                          } } in
                                    case GHC.Classes.eqInt bound_a1kF (GHC.Types.I# -1#) of {
                                      False -> jump $j_a23n;
                                      True ->
                                        case GHC.Classes.eqInt (GHC.Types.I# a_s272) GHC.Base.minInt
                                        of {
                                          False -> jump $j_a23n;
                                          True -> GHC.Real.overflowError @Int
                                        }
                                    };
                                  True -> GHC.Real.divZeroError @Int
                                } } in
                          case GHC.Classes.geInt i1_X3 iend1_a1wD of {
                            False ->
                              case GHC.Classes.gtInt outRemaining_a1z7 (GHC.Types.I# 0#) of {
                                False ->
                                  (\ (s_a244 [Occ=Once1] :: GHC.Prim.State# GHC.Prim.RealWorld) ->
                                     (# s_a244,
                                        Data.ByteString.Builder.Internal.$WBufferFull
                                          @r_a238
                                          bound_a1kF
                                          (GHC.Ptr.Ptr @Word8 bx3_d22P)
                                          (outerLoop_a1TC i1_X3) #))
                                  `cast` (Sym (GHC.Types.N:IO[0] <B.BuildSignal r_a238>_R)
                                          :: (GHC.Prim.State# GHC.Prim.RealWorld
                                              -> (# GHC.Prim.State# GHC.Prim.RealWorld,
                                                    B.BuildSignal r_a238 #))
                                             ~R# IO (B.BuildSignal r_a238));
                                True ->
                                  case outRemaining_a1z7 of { GHC.Types.I# x1_a24o ->
                                  let {
                                    y1_a24r :: GHC.Prim.Int#
                                    [LclId]
                                    y1_a24r = GHC.Prim.-# iend_s26Z ipv_s270 } in
                                  join {
                                    $j_s27Q [Occ=Once2!T[1]]
                                      :: GHC.Prim.Int# -> IO (B.BuildSignal r_a238)
                                    [LclId[JoinId(1)(Nothing)], Arity=1, Unf=OtherCon []]
                                    $j_s27Q (y_a23f [Occ=Once1, OS=OneShot] :: GHC.Prim.Int#)
                                      = let {
                                          iendTmp_s273 [Occ=OnceL1] :: GHC.Prim.Int#
                                          [LclId]
                                          iendTmp_s273 = GHC.Prim.+# ipv_s270 y_a23f } in
                                        let {
                                          iendTmp1_X7 [Occ=OnceL1] :: Int
                                          [LclId, Unf=OtherCon []]
                                          iendTmp1_X7 = GHC.Types.I# iendTmp_s273 } in
                                        letrec {
                                          go_a1U2 [Occ=LoopBreaker]
                                            :: Int -> Ptr Word8 -> IO (B.BuildSignal r_a238)
                                          [LclId, Arity=3, Unf=OtherCon []]
                                          go_a1U2
                                            = \ (i_a1ED [Occ=Once1!] :: Int)
                                                (op_a1EE [Occ=Once1!] :: Ptr Word8) ->
                                                case i_a1ED of i2_X9 { GHC.Types.I# ipv1_s274 ->
                                                case op_a1EE of op1_Xa [Occ=Once2]
                                                { GHC.Ptr.Ptr ipv2_s276 ->
                                                case GHC.Classes.ltInt i2_X9 iendTmp1_X7 of {
                                                  False ->
                                                    outerLoop_a1TC
                                                      i2_X9
                                                      (Data.ByteString.Builder.Internal.$WBufferRange
                                                         op1_Xa ope_a1z6);
                                                  True ->
                                                    let {
                                                      w_a1EF :: Word8
                                                      [LclId]
                                                      w_a1EF
                                                        = case GHC.Prim.indexWord8Array#
                                                                 bx_d22M ipv1_s274
                                                          of r#_a24P [Occ=Once1]
                                                          { __DEFAULT ->
                                                          GHC.Word.W8# r#_a24P
                                                          } } in
                                                    case GHC.Word.ltWord8
                                                           w_a1EF (GHC.Word.W8# 128#Word8)
                                                    of {
                                                      False ->
                                                        (\ (s_a25B [Occ=Once1]
                                                              :: GHC.Prim.State#
                                                                   GHC.Prim.RealWorld) ->
                                                           case w_a1EF of
                                                           { GHC.Word.W8# x_a26s [Occ=Once1] ->
                                                           case GHC.Prim.writeWord8OffAddr#
                                                                  @GHC.Prim.RealWorld
                                                                  ipv2_s276
                                                                  0#
                                                                  x_a26s
                                                                  s_a25B
                                                           of s2_a26u [Occ=Once1]
                                                           { __DEFAULT ->
                                                           ((go_a1U2
                                                               (GHC.Types.I#
                                                                  (GHC.Prim.+# ipv1_s274 1#))
                                                               (GHC.Ptr.Ptr
                                                                  @Word8
                                                                  (GHC.Prim.plusAddr#
                                                                     ipv2_s276 1#)))
                                                            `cast` (GHC.Types.N:IO[0]
                                                                        <B.BuildSignal r_a238>_R
                                                                    :: IO (B.BuildSignal r_a238)
                                                                       ~R# (GHC.Prim.State#
                                                                              GHC.Prim.RealWorld
                                                                            -> (# GHC.Prim.State#
                                                                                    GHC.Prim.RealWorld,
                                                                                  B.BuildSignal
                                                                                    r_a238 #))))
                                                             s2_a26u
                                                           }
                                                           })
                                                        `cast` (Sym (GHC.Types.N:IO[0]
                                                                         <B.BuildSignal r_a238>_R)
                                                                :: (GHC.Prim.State#
                                                                      GHC.Prim.RealWorld
                                                                    -> (# GHC.Prim.State#
                                                                            GHC.Prim.RealWorld,
                                                                          B.BuildSignal r_a238 #))
                                                                   ~R# IO (B.BuildSignal r_a238));
                                                      True ->
                                                        (\ (s_a26J [Occ=Once1]
                                                              :: GHC.Prim.State#
                                                                   GHC.Prim.RealWorld) ->
                                                           case be_a1kE of
                                                           { Data.ByteString.Builder.Prim.Internal.BP _ [Occ=Dead]
                                                                                                      io_a26V [Occ=Once1!] ->
                                                           case ((io_a26V w_a1EF op1_Xa)
                                                                 `cast` (GHC.Types.N:IO[0]
                                                                             <Ptr Word8>_R
                                                                         :: IO (Ptr Word8)
                                                                            ~R# (GHC.Prim.State#
                                                                                   GHC.Prim.RealWorld
                                                                                 -> (# GHC.Prim.State#
                                                                                         GHC.Prim.RealWorld,
                                                                                       Ptr
                                                                                         Word8 #))))
                                                                  s_a26J
                                                           of
                                                           { (# ipv3_a26L [Occ=Once1],
                                                                ipv4_a26M [Occ=Once1] #) ->
                                                           ((go_a1U2
                                                               (GHC.Types.I#
                                                                  (GHC.Prim.+# ipv1_s274 1#))
                                                               ipv4_a26M)
                                                            `cast` (GHC.Types.N:IO[0]
                                                                        <B.BuildSignal r_a238>_R
                                                                    :: IO (B.BuildSignal r_a238)
                                                                       ~R# (GHC.Prim.State#
                                                                              GHC.Prim.RealWorld
                                                                            -> (# GHC.Prim.State#
                                                                                    GHC.Prim.RealWorld,
                                                                                  B.BuildSignal
                                                                                    r_a238 #))))
                                                             ipv3_a26L
                                                           }
                                                           })
                                                        `cast` (Sym (GHC.Types.N:IO[0]
                                                                         <B.BuildSignal r_a238>_R)
                                                                :: (GHC.Prim.State#
                                                                      GHC.Prim.RealWorld
                                                                    -> (# GHC.Prim.State#
                                                                            GHC.Prim.RealWorld,
                                                                          B.BuildSignal r_a238 #))
                                                                   ~R# IO (B.BuildSignal r_a238))
                                                    }
                                                }
                                                }
                                                }; } in
                                        go_a1U2 i1_X3 (GHC.Ptr.Ptr @Word8 bx3_d22P) } in
                                  case GHC.Prim.<=# x1_a24o y1_a24r of {
                                    __DEFAULT -> jump $j_s27Q y1_a24r;
                                    1# -> jump $j_s27Q x1_a24o
                                  }
                                  }
                              };
                            True -> k_X2 wild1_X4
                          }
                          }
                          }; } in
                  ((outerLoop_a1TC (GHC.Types.I# bx1_d22N) eta2_B2)
                   `cast` (GHC.Types.N:IO[0] <B.BuildSignal r_a238>_R
                           :: IO (B.BuildSignal r_a238)
                              ~R# (GHC.Prim.State# GHC.Prim.RealWorld
                                   -> (# GHC.Prim.State# GHC.Prim.RealWorld,
                                         B.BuildSignal r_a238 #))))
                    eta3_B3
                  }
                  })
               `cast` (<BP.BoundedPrim Word8>_R
                       %<'Many>_N ->_R <Text>_R
                       %<'Many>_N ->_R forall (r :: <*>_N).
                                       <B.BuildStep (r |> <*>_N)>_R
                                       %<'Many>_N ->_R <B.BufferRange>_R
                                       %<'Many>_N ->_R Sym (GHC.Types.N:IO[0]
                                                                <B.BuildSignal (r |> <*>_N)>_R)
                                       ; Sym (Data.ByteString.Builder.Internal.N:Builder[0])
                       :: (BP.BoundedPrim Word8
                           -> Text
                           -> forall {r}.
                              B.BuildStep (r |> <*>_N)
                              -> B.BufferRange
                              -> GHC.Prim.State# GHC.Prim.RealWorld
                              -> (# GHC.Prim.State# GHC.Prim.RealWorld,
                                    B.BuildSignal (r |> <*>_N) #))
                          ~R# (BP.BoundedPrim Word8 -> Text -> B.Builder))}]
encodeUtf8BuilderEscaped
  = (\ (be_a1kE :: BP.BoundedPrim Word8)
       (eta_B0 :: Text)
       (@r_a238)
       (eta1_B1 :: B.BuildStep r_a238)
       (eta2_B2 :: B.BufferRange)
       (eta3_B3 [OS=OneShot] :: GHC.Prim.State# GHC.Prim.RealWorld) ->
       case eta_B0 of { Text bx_d22M bx1_d22N bx2_d22O ->
       case eta1_B1 of k_X2 { __DEFAULT ->
       let {
         iend_s27f :: GHC.Prim.Int#
         [LclId]
         iend_s27f = GHC.Prim.+# bx1_d22N bx2_d22O } in
       case eta2_B2 of wild1_X5 { B.BufferRange bx3_d22P bx4_d22Q ->
       case GHC.Prim.>=# bx1_d22N iend_s27f of {
         __DEFAULT ->
           case be_a1kE of
           { Data.ByteString.Builder.Prim.Internal.BP bx5_a27M ds1_a27N ->
           join {
             $j_s28Z [Dmd=1C(1,L)]
               :: GHC.Prim.Int#
                  -> (# GHC.Prim.State# GHC.Prim.RealWorld, B.BuildSignal r_a238 #)
             [LclId[JoinId(1)(Nothing)], Arity=1, Str=<1L>, Unf=OtherCon []]
             $j_s28Z (x_a27U [OS=OneShot] :: GHC.Prim.Int#)
               = case x_a27U of wild3_X6 {
                   __DEFAULT ->
                     let {
                       a_s27n :: GHC.Prim.Int#
                       [LclId]
                       a_s27n = GHC.Prim.minusAddr# bx4_d22Q bx3_d22P } in
                     join {
                       $j1_s27p [Dmd=1!P(L,L)]
                         :: (# GHC.Prim.State# GHC.Prim.RealWorld, B.BuildSignal r_a238 #)
                       [LclId[JoinId(0)(Nothing)]]
                       $j1_s27p
                         = case GHC.Prim.quotInt# a_s27n wild3_X6 of ds2_a23R { __DEFAULT ->
                           case GHC.Prim.># ds2_a23R 0# of {
                             __DEFAULT ->
                               (# eta3_B3,
                                  Data.ByteString.Builder.Internal.BufferFull
                                    @r_a238
                                    wild3_X6
                                    bx3_d22P
                                    ((\ (br_X7 :: B.BufferRange)
                                        (eta4_X8 [OS=OneShot]
                                           :: GHC.Prim.State# GHC.Prim.RealWorld) ->
                                        letrec {
                                          $s$wouterLoop_s29Y [Occ=LoopBreaker,
                                                              Dmd=LC(S,C(1,C(1,C(1,!P(L,L)))))]
                                            :: GHC.Prim.Addr#
                                               -> GHC.Prim.Addr#
                                               -> GHC.Prim.Int#
                                               -> GHC.Prim.State# GHC.Prim.RealWorld
                                               -> (# GHC.Prim.State# GHC.Prim.RealWorld,
                                                     B.BuildSignal r_a238 #)
                                          [LclId, Arity=4, Str=<L><L><L><L>, Unf=OtherCon []]
                                          $s$wouterLoop_s29Y
                                            = \ (sc_s29V :: GHC.Prim.Addr#)
                                                (sc1_s29W :: GHC.Prim.Addr#)
                                                (sc2_s29U :: GHC.Prim.Int#)
                                                (eta5_s28W [OS=OneShot]
                                                   :: GHC.Prim.State# GHC.Prim.RealWorld) ->
                                                case GHC.Prim.>=# sc2_s29U iend_s27f of {
                                                  __DEFAULT ->
                                                    let {
                                                      a1_Xe :: GHC.Prim.Int#
                                                      [LclId]
                                                      a1_Xe
                                                        = GHC.Prim.minusAddr# sc1_s29W sc_s29V } in
                                                    join {
                                                      $j2_Xf [Dmd=1!P(L,L)]
                                                        :: (# GHC.Prim.State# GHC.Prim.RealWorld,
                                                              B.BuildSignal r_a238 #)
                                                      [LclId[JoinId(0)(Nothing)]]
                                                      $j2_Xf
                                                        = case GHC.Prim.quotInt# a1_Xe wild3_X6
                                                          of ds4_Xg
                                                          { __DEFAULT ->
                                                          case GHC.Prim.># ds4_Xg 0# of {
                                                            __DEFAULT ->
                                                              (# eta5_s28W,
                                                                 Data.ByteString.Builder.Internal.BufferFull
                                                                   @r_a238
                                                                   wild3_X6
                                                                   sc_s29V
                                                                   ((\ (br1_Xi :: B.BufferRange)
                                                                       (eta6_Xj [OS=OneShot]
                                                                          :: GHC.Prim.State#
                                                                               GHC.Prim.RealWorld) ->
                                                                       $wouterLoop_s28Y
                                                                         sc2_s29U br1_Xi eta6_Xj)
                                                                    `cast` (<B.BufferRange>_R
                                                                            %<'Many>_N ->_R Sym (GHC.Types.N:IO[0]
                                                                                                     <B.BuildSignal
                                                                                                        r_a238>_R)
                                                                            :: (B.BufferRange
                                                                                -> GHC.Prim.State#
                                                                                     GHC.Prim.RealWorld
                                                                                -> (# GHC.Prim.State#
                                                                                        GHC.Prim.RealWorld,
                                                                                      B.BuildSignal
                                                                                        r_a238 #))
                                                                               ~R# (B.BufferRange
                                                                                    -> IO
                                                                                         (B.BuildSignal
                                                                                            r_a238)))) #);
                                                            1# ->
                                                              let {
                                                                y1_s27t :: GHC.Prim.Int#
                                                                [LclId]
                                                                y1_s27t
                                                                  = GHC.Prim.-#
                                                                      iend_s27f sc2_s29U } in
                                                              join {
                                                                $j3_s27P [Dmd=1C(1,!P(L,L))]
                                                                  :: GHC.Prim.Int#
                                                                     -> (# GHC.Prim.State#
                                                                             GHC.Prim.RealWorld,
                                                                           B.BuildSignal r_a238 #)
                                                                [LclId[JoinId(1)(Nothing)],
                                                                 Arity=1,
                                                                 Str=<L>,
                                                                 Unf=OtherCon []]
                                                                $j3_s27P (y_a23f [OS=OneShot]
                                                                            :: GHC.Prim.Int#)
                                                                  = let {
                                                                      iendTmp_s27v :: GHC.Prim.Int#
                                                                      [LclId]
                                                                      iendTmp_s27v
                                                                        = GHC.Prim.+#
                                                                            sc2_s29U y_a23f } in
                                                                    joinrec {
                                                                      $s$wgo_s2ai [Occ=LoopBreaker,
                                                                                   Dmd=SC(S,C(1,C(1,!P(L,L))))]
                                                                        :: GHC.Prim.State#
                                                                             GHC.Prim.RealWorld
                                                                           -> GHC.Prim.Addr#
                                                                           -> GHC.Prim.Int#
                                                                           -> (# GHC.Prim.State#
                                                                                   GHC.Prim.RealWorld,
                                                                                 B.BuildSignal
                                                                                   r_a238 #)
                                                                      [LclId[JoinId(3)(Nothing)],
                                                                       Arity=3,
                                                                       Str=<L><L><L>,
                                                                       Unf=OtherCon []]
                                                                      $s$wgo_s2ai (sc3_s2ah
                                                                                     :: GHC.Prim.State#
                                                                                          GHC.Prim.RealWorld)
                                                                                  (sc4_s2ag
                                                                                     :: GHC.Prim.Addr#)
                                                                                  (sc5_s2af
                                                                                     :: GHC.Prim.Int#)
                                                                        = case GHC.Prim.<#
                                                                                 sc5_s2af
                                                                                 iendTmp_s27v
                                                                          of {
                                                                            __DEFAULT ->
                                                                              $s$wouterLoop_s29Y
                                                                                sc4_s2ag
                                                                                sc1_s29W
                                                                                sc5_s2af
                                                                                sc3_s2ah;
                                                                            1# ->
                                                                              case GHC.Prim.indexWord8Array#
                                                                                     bx_d22M
                                                                                     sc5_s2af
                                                                              of r#_a24P
                                                                              { __DEFAULT ->
                                                                              case GHC.Prim.ltWord8#
                                                                                     r#_a24P 128#Word8
                                                                              of {
                                                                                __DEFAULT ->
                                                                                  case GHC.Prim.writeWord8OffAddr#
                                                                                         @GHC.Prim.RealWorld
                                                                                         sc4_s2ag
                                                                                         0#
                                                                                         r#_a24P
                                                                                         sc3_s2ah
                                                                                  of s2_a26u
                                                                                  { __DEFAULT ->
                                                                                  jump $s$wgo_s2ai
                                                                                    s2_a26u
                                                                                    (GHC.Prim.plusAddr#
                                                                                       sc4_s2ag 1#)
                                                                                    (GHC.Prim.+#
                                                                                       sc5_s2af 1#)
                                                                                  };
                                                                                1# ->
                                                                                  case ((ds1_a27N
                                                                                           (GHC.Word.W8#
                                                                                              r#_a24P)
                                                                                           (GHC.Ptr.Ptr
                                                                                              @Word8
                                                                                              sc4_s2ag))
                                                                                        `cast` (GHC.Types.N:IO[0]
                                                                                                    <Ptr
                                                                                                       Word8>_R
                                                                                                :: IO
                                                                                                     (Ptr
                                                                                                        Word8)
                                                                                                   ~R# (GHC.Prim.State#
                                                                                                          GHC.Prim.RealWorld
                                                                                                        -> (# GHC.Prim.State#
                                                                                                                GHC.Prim.RealWorld,
                                                                                                              Ptr
                                                                                                                Word8 #))))
                                                                                         sc3_s2ah
                                                                                  of
                                                                                  { (# ipv_a26L,
                                                                                       ipv1_a26M #) ->
                                                                                  joinrec {
                                                                                    $wgo_Xk [InlPrag=[2],
                                                                                             Occ=LoopBreaker,
                                                                                             Dmd=SC(S,C(1,C(1,!P(L,L))))]
                                                                                      :: GHC.Prim.Int#
                                                                                         -> Ptr
                                                                                              Word8
                                                                                         -> GHC.Prim.State#
                                                                                              GHC.Prim.RealWorld
                                                                                         -> (# GHC.Prim.State#
                                                                                                 GHC.Prim.RealWorld,
                                                                                               B.BuildSignal
                                                                                                 r_a238 #)
                                                                                    [LclId[JoinId(3)(Just [~,
                                                                                                           !])],
                                                                                     Arity=3,
                                                                                     Str=<L><1L><L>,
                                                                                     Unf=OtherCon []]
                                                                                    $wgo_Xk (ww_Xl
                                                                                               :: GHC.Prim.Int#)
                                                                                            (op_Xm
                                                                                               :: Ptr
                                                                                                    Word8)
                                                                                            (eta6_Xn [OS=OneShot]
                                                                                               :: GHC.Prim.State#
                                                                                                    GHC.Prim.RealWorld)
                                                                                      = case op_Xm
                                                                                        of op1_Xo
                                                                                        { GHC.Ptr.Ptr ipv2_Xp ->
                                                                                        case GHC.Prim.<#
                                                                                               ww_Xl
                                                                                               iendTmp_s27v
                                                                                        of {
                                                                                          __DEFAULT ->
                                                                                            $s$wouterLoop_s29Y
                                                                                              ipv2_Xp
                                                                                              sc1_s29W
                                                                                              ww_Xl
                                                                                              eta6_Xn;
                                                                                          1# ->
                                                                                            case GHC.Prim.indexWord8Array#
                                                                                                   bx_d22M
                                                                                                   ww_Xl
                                                                                            of r#1_Xr
                                                                                            { __DEFAULT ->
                                                                                            case GHC.Prim.ltWord8#
                                                                                                   r#1_Xr
                                                                                                   128#Word8
                                                                                            of {
                                                                                              __DEFAULT ->
                                                                                                case GHC.Prim.writeWord8OffAddr#
                                                                                                       @GHC.Prim.RealWorld
                                                                                                       ipv2_Xp
                                                                                                       0#
                                                                                                       r#1_Xr
                                                                                                       eta6_Xn
                                                                                                of s2_a26u
                                                                                                { __DEFAULT ->
                                                                                                jump $wgo_Xk
                                                                                                  (GHC.Prim.+#
                                                                                                     ww_Xl
                                                                                                     1#)
                                                                                                  (GHC.Ptr.Ptr
                                                                                                     @Word8
                                                                                                     (GHC.Prim.plusAddr#
                                                                                                        ipv2_Xp
                                                                                                        1#))
                                                                                                  s2_a26u
                                                                                                };
                                                                                              1# ->
                                                                                                case ((ds1_a27N
                                                                                                         (GHC.Word.W8#
                                                                                                            r#1_Xr)
                                                                                                         op1_Xo)
                                                                                                      `cast` (GHC.Types.N:IO[0]
                                                                                                                  <Ptr
                                                                                                                     Word8>_R
                                                                                                              :: IO
                                                                                                                   (Ptr
                                                                                                                      Word8)
                                                                                                                 ~R# (GHC.Prim.State#
                                                                                                                        GHC.Prim.RealWorld
                                                                                                                      -> (# GHC.Prim.State#
                                                                                                                              GHC.Prim.RealWorld,
                                                                                                                            Ptr
                                                                                                                              Word8 #))))
                                                                                                       eta6_Xn
                                                                                                of
                                                                                                { (# ipv3_Xu,
                                                                                                     ipv4_Xv #) ->
                                                                                                jump $wgo_Xk
                                                                                                  (GHC.Prim.+#
                                                                                                     ww_Xl
                                                                                                     1#)
                                                                                                  ipv4_Xv
                                                                                                  ipv3_Xu
                                                                                                }
                                                                                            }
                                                                                            }
                                                                                        }
                                                                                        }; } in
                                                                                  jump $wgo_Xk
                                                                                    (GHC.Prim.+#
                                                                                       sc5_s2af 1#)
                                                                                    ipv1_a26M
                                                                                    ipv_a26L
                                                                                  }
                                                                              }
                                                                              }
                                                                          }; } in
                                                                    jump $s$wgo_s2ai
                                                                      eta5_s28W
                                                                      sc_s29V
                                                                      sc2_s29U } in
                                                              case GHC.Prim.<=# ds4_Xg y1_s27t of {
                                                                __DEFAULT -> jump $j3_s27P y1_s27t;
                                                                1# -> jump $j3_s27P ds4_Xg
                                                              }
                                                          }
                                                          } } in
                                                    case wild3_X6 of {
                                                      __DEFAULT -> jump $j2_Xf;
                                                      -1# ->
                                                        case a1_Xe of {
                                                          __DEFAULT -> jump $j2_Xf;
                                                          -9223372036854775808# ->
                                                            case GHC.Real.overflowError
                                                            of wild6_00 {
                                                            }
                                                        }
                                                    };
                                                  1# ->
                                                    ((k_X2
                                                        (Data.ByteString.Builder.Internal.BufferRange
                                                           sc_s29V sc1_s29W))
                                                     `cast` (GHC.Types.N:IO[0]
                                                                 <B.BuildSignal r_a238>_R
                                                             :: IO (B.BuildSignal r_a238)
                                                                ~R# (GHC.Prim.State#
                                                                       GHC.Prim.RealWorld
                                                                     -> (# GHC.Prim.State#
                                                                             GHC.Prim.RealWorld,
                                                                           B.BuildSignal
                                                                             r_a238 #))))
                                                      eta5_s28W
                                                };
                                          $wouterLoop_s28Y [InlPrag=[2],
                                                            Occ=LoopBreaker,
                                                            Dmd=SC(S,C(1,C(1,L)))]
                                            :: GHC.Prim.Int#
                                               -> B.BufferRange
                                               -> GHC.Prim.State# GHC.Prim.RealWorld
                                               -> (# GHC.Prim.State# GHC.Prim.RealWorld,
                                                     B.BuildSignal r_a238 #)
                                          [LclId[StrictWorker([~, !])],
                                           Arity=3,
                                           Str=<L><1L><L>,
                                           Unf=OtherCon []]
                                          $wouterLoop_s28Y
                                            = \ (ww_s28T :: GHC.Prim.Int#)
                                                (br1_s28V :: B.BufferRange)
                                                (eta5_s28W [OS=OneShot]
                                                   :: GHC.Prim.State# GHC.Prim.RealWorld) ->
                                                case br1_s28V of wild4_X9
                                                { B.BufferRange bx6_Xa bx7_Xb ->
                                                case GHC.Prim.>=# ww_s28T iend_s27f of {
                                                  __DEFAULT ->
                                                    let {
                                                      a1_Xe :: GHC.Prim.Int#
                                                      [LclId]
                                                      a1_Xe = GHC.Prim.minusAddr# bx7_Xb bx6_Xa } in
                                                    join {
                                                      $j2_Xf [Dmd=1!P(L,L)]
                                                        :: (# GHC.Prim.State# GHC.Prim.RealWorld,
                                                              B.BuildSignal r_a238 #)
                                                      [LclId[JoinId(0)(Nothing)]]
                                                      $j2_Xf
                                                        = case GHC.Prim.quotInt# a1_Xe wild3_X6
                                                          of ds4_Xg
                                                          { __DEFAULT ->
                                                          case GHC.Prim.># ds4_Xg 0# of {
                                                            __DEFAULT ->
                                                              (# eta5_s28W,
                                                                 Data.ByteString.Builder.Internal.BufferFull
                                                                   @r_a238
                                                                   wild3_X6
                                                                   bx6_Xa
                                                                   ((\ (br2_Xi :: B.BufferRange)
                                                                       (eta6_Xj [OS=OneShot]
                                                                          :: GHC.Prim.State#
                                                                               GHC.Prim.RealWorld) ->
                                                                       $wouterLoop_s28Y
                                                                         ww_s28T br2_Xi eta6_Xj)
                                                                    `cast` (<B.BufferRange>_R
                                                                            %<'Many>_N ->_R Sym (GHC.Types.N:IO[0]
                                                                                                     <B.BuildSignal
                                                                                                        r_a238>_R)
                                                                            :: (B.BufferRange
                                                                                -> GHC.Prim.State#
                                                                                     GHC.Prim.RealWorld
                                                                                -> (# GHC.Prim.State#
                                                                                        GHC.Prim.RealWorld,
                                                                                      B.BuildSignal
                                                                                        r_a238 #))
                                                                               ~R# (B.BufferRange
                                                                                    -> IO
                                                                                         (B.BuildSignal
                                                                                            r_a238)))) #);
                                                            1# ->
                                                              let {
                                                                y1_s27t :: GHC.Prim.Int#
                                                                [LclId]
                                                                y1_s27t
                                                                  = GHC.Prim.-#
                                                                      iend_s27f ww_s28T } in
                                                              join {
                                                                $j3_s27P [Dmd=1C(1,!P(L,L))]
                                                                  :: GHC.Prim.Int#
                                                                     -> (# GHC.Prim.State#
                                                                             GHC.Prim.RealWorld,
                                                                           B.BuildSignal r_a238 #)
                                                                [LclId[JoinId(1)(Nothing)],
                                                                 Arity=1,
                                                                 Str=<L>,
                                                                 Unf=OtherCon []]
                                                                $j3_s27P (y_a23f [OS=OneShot]
                                                                            :: GHC.Prim.Int#)
                                                                  = let {
                                                                      iendTmp_s27v :: GHC.Prim.Int#
                                                                      [LclId]
                                                                      iendTmp_s27v
                                                                        = GHC.Prim.+#
                                                                            ww_s28T y_a23f } in
                                                                    joinrec {
                                                                      $s$wgo_s29j [Occ=LoopBreaker,
                                                                                   Dmd=SC(S,C(1,C(1,!P(L,L))))]
                                                                        :: GHC.Prim.State#
                                                                             GHC.Prim.RealWorld
                                                                           -> GHC.Prim.Addr#
                                                                           -> GHC.Prim.Int#
                                                                           -> (# GHC.Prim.State#
                                                                                   GHC.Prim.RealWorld,
                                                                                 B.BuildSignal
                                                                                   r_a238 #)
                                                                      [LclId[JoinId(3)(Nothing)],
                                                                       Arity=3,
                                                                       Str=<L><L><L>,
                                                                       Unf=OtherCon []]
                                                                      $s$wgo_s29j (sc_s29i
                                                                                     :: GHC.Prim.State#
                                                                                          GHC.Prim.RealWorld)
                                                                                  (sc1_s29h
                                                                                     :: GHC.Prim.Addr#)
                                                                                  (sc2_s29g
                                                                                     :: GHC.Prim.Int#)
                                                                        = case GHC.Prim.<#
                                                                                 sc2_s29g
                                                                                 iendTmp_s27v
                                                                          of {
                                                                            __DEFAULT ->
                                                                              $s$wouterLoop_s29Y
                                                                                sc1_s29h
                                                                                bx7_Xb
                                                                                sc2_s29g
                                                                                sc_s29i;
                                                                            1# ->
                                                                              case GHC.Prim.indexWord8Array#
                                                                                     bx_d22M
                                                                                     sc2_s29g
                                                                              of r#_a24P
                                                                              { __DEFAULT ->
                                                                              case GHC.Prim.ltWord8#
                                                                                     r#_a24P 128#Word8
                                                                              of {
                                                                                __DEFAULT ->
                                                                                  case GHC.Prim.writeWord8OffAddr#
                                                                                         @GHC.Prim.RealWorld
                                                                                         sc1_s29h
                                                                                         0#
                                                                                         r#_a24P
                                                                                         sc_s29i
                                                                                  of s2_a26u
                                                                                  { __DEFAULT ->
                                                                                  jump $s$wgo_s29j
                                                                                    s2_a26u
                                                                                    (GHC.Prim.plusAddr#
                                                                                       sc1_s29h 1#)
                                                                                    (GHC.Prim.+#
                                                                                       sc2_s29g 1#)
                                                                                  };
                                                                                1# ->
                                                                                  case ((ds1_a27N
                                                                                           (GHC.Word.W8#
                                                                                              r#_a24P)
                                                                                           (GHC.Ptr.Ptr
                                                                                              @Word8
                                                                                              sc1_s29h))
                                                                                        `cast` (GHC.Types.N:IO[0]
                                                                                                    <Ptr
                                                                                                       Word8>_R
                                                                                                :: IO
                                                                                                     (Ptr
                                                                                                        Word8)
                                                                                                   ~R# (GHC.Prim.State#
                                                                                                          GHC.Prim.RealWorld
                                                                                                        -> (# GHC.Prim.State#
                                                                                                                GHC.Prim.RealWorld,
                                                                                                              Ptr
                                                                                                                Word8 #))))
                                                                                         sc_s29i
                                                                                  of
                                                                                  { (# ipv_a26L,
                                                                                       ipv1_a26M #) ->
                                                                                  joinrec {
                                                                                    $s$wgo1_s29t [Occ=LoopBreaker,
                                                                                                  Dmd=LC(S,C(1,C(1,!P(L,L))))]
                                                                                      :: GHC.Prim.State#
                                                                                           GHC.Prim.RealWorld
                                                                                         -> GHC.Prim.Addr#
                                                                                         -> GHC.Prim.Int#
                                                                                         -> (# GHC.Prim.State#
                                                                                                 GHC.Prim.RealWorld,
                                                                                               B.BuildSignal
                                                                                                 r_a238 #)
                                                                                    [LclId[JoinId(3)(Nothing)],
                                                                                     Arity=3,
                                                                                     Str=<L><L><L>,
                                                                                     Unf=OtherCon []]
                                                                                    $s$wgo1_s29t (sc3_s29p
                                                                                                    :: GHC.Prim.State#
                                                                                                         GHC.Prim.RealWorld)
                                                                                                 (sc4_s29o
                                                                                                    :: GHC.Prim.Addr#)
                                                                                                 (sc5_s29n
                                                                                                    :: GHC.Prim.Int#)
                                                                                      = case GHC.Prim.<#
                                                                                               sc5_s29n
                                                                                               iendTmp_s27v
                                                                                        of {
                                                                                          __DEFAULT ->
                                                                                            $s$wouterLoop_s29Y
                                                                                              sc4_s29o
                                                                                              bx7_Xb
                                                                                              sc5_s29n
                                                                                              sc3_s29p;
                                                                                          1# ->
                                                                                            case GHC.Prim.indexWord8Array#
                                                                                                   bx_d22M
                                                                                                   sc5_s29n
                                                                                            of r#1_Xr
                                                                                            { __DEFAULT ->
                                                                                            case GHC.Prim.ltWord8#
                                                                                                   r#1_Xr
                                                                                                   128#Word8
                                                                                            of {
                                                                                              __DEFAULT ->
                                                                                                case GHC.Prim.writeWord8OffAddr#
                                                                                                       @GHC.Prim.RealWorld
                                                                                                       sc4_s29o
                                                                                                       0#
                                                                                                       r#1_Xr
                                                                                                       sc3_s29p
                                                                                                of s2_a26u
                                                                                                { __DEFAULT ->
                                                                                                jump $s$wgo1_s29t
                                                                                                  s2_a26u
                                                                                                  (GHC.Prim.plusAddr#
                                                                                                     sc4_s29o
                                                                                                     1#)
                                                                                                  (GHC.Prim.+#
                                                                                                     sc5_s29n
                                                                                                     1#)
                                                                                                };
                                                                                              1# ->
                                                                                                case ((ds1_a27N
                                                                                                         (GHC.Word.W8#
                                                                                                            r#1_Xr)
                                                                                                         (GHC.Ptr.Ptr
                                                                                                            @Word8
                                                                                                            sc4_s29o))
                                                                                                      `cast` (GHC.Types.N:IO[0]
                                                                                                                  <Ptr
                                                                                                                     Word8>_R
                                                                                                              :: IO
                                                                                                                   (Ptr
                                                                                                                      Word8)
                                                                                                                 ~R# (GHC.Prim.State#
                                                                                                                        GHC.Prim.RealWorld
                                                                                                                      -> (# GHC.Prim.State#
                                                                                                                              GHC.Prim.RealWorld,
                                                                                                                            Ptr
                                                                                                                              Word8 #))))
                                                                                                       sc3_s29p
                                                                                                of
                                                                                                { (# ipv2_Xu,
                                                                                                     ipv3_Xv #) ->
                                                                                                jump $wgo_Xk
                                                                                                  (GHC.Prim.+#
                                                                                                     sc5_s29n
                                                                                                     1#)
                                                                                                  ipv3_Xv
                                                                                                  ipv2_Xu
                                                                                                }
                                                                                            }
                                                                                            }
                                                                                        };
                                                                                    $wgo_Xk [InlPrag=[2],
                                                                                             Occ=LoopBreaker,
                                                                                             Dmd=SC(S,C(1,C(1,!P(L,L))))]
                                                                                      :: GHC.Prim.Int#
                                                                                         -> Ptr
                                                                                              Word8
                                                                                         -> GHC.Prim.State#
                                                                                              GHC.Prim.RealWorld
                                                                                         -> (# GHC.Prim.State#
                                                                                                 GHC.Prim.RealWorld,
                                                                                               B.BuildSignal
                                                                                                 r_a238 #)
                                                                                    [LclId[JoinId(3)(Just [~,
                                                                                                           !])],
                                                                                     Arity=3,
                                                                                     Str=<L><1L><L>,
                                                                                     Unf=OtherCon []]
                                                                                    $wgo_Xk (ww1_Xl
                                                                                               :: GHC.Prim.Int#)
                                                                                            (op_Xm
                                                                                               :: Ptr
                                                                                                    Word8)
                                                                                            (eta6_Xn [OS=OneShot]
                                                                                               :: GHC.Prim.State#
                                                                                                    GHC.Prim.RealWorld)
                                                                                      = case op_Xm
                                                                                        of op1_Xo
                                                                                        { GHC.Ptr.Ptr ipv2_Xp ->
                                                                                        case GHC.Prim.<#
                                                                                               ww1_Xl
                                                                                               iendTmp_s27v
                                                                                        of {
                                                                                          __DEFAULT ->
                                                                                            $s$wouterLoop_s29Y
                                                                                              ipv2_Xp
                                                                                              bx7_Xb
                                                                                              ww1_Xl
                                                                                              eta6_Xn;
                                                                                          1# ->
                                                                                            case GHC.Prim.indexWord8Array#
                                                                                                   bx_d22M
                                                                                                   ww1_Xl
                                                                                            of r#1_Xr
                                                                                            { __DEFAULT ->
                                                                                            case GHC.Prim.ltWord8#
                                                                                                   r#1_Xr
                                                                                                   128#Word8
                                                                                            of {
                                                                                              __DEFAULT ->
                                                                                                case GHC.Prim.writeWord8OffAddr#
                                                                                                       @GHC.Prim.RealWorld
                                                                                                       ipv2_Xp
                                                                                                       0#
                                                                                                       r#1_Xr
                                                                                                       eta6_Xn
                                                                                                of s2_a26u
                                                                                                { __DEFAULT ->
                                                                                                jump $s$wgo1_s29t
                                                                                                  s2_a26u
                                                                                                  (GHC.Prim.plusAddr#
                                                                                                     ipv2_Xp
                                                                                                     1#)
                                                                                                  (GHC.Prim.+#
                                                                                                     ww1_Xl
                                                                                                     1#)
                                                                                                };
                                                                                              1# ->
                                                                                                case ((ds1_a27N
                                                                                                         (GHC.Word.W8#
                                                                                                            r#1_Xr)
                                                                                                         op1_Xo)
                                                                                                      `cast` (GHC.Types.N:IO[0]
                                                                                                                  <Ptr
                                                                                                                     Word8>_R
                                                                                                              :: IO
                                                                                                                   (Ptr
                                                                                                                      Word8)
                                                                                                                 ~R# (GHC.Prim.State#
                                                                                                                        GHC.Prim.RealWorld
                                                                                                                      -> (# GHC.Prim.State#
                                                                                                                              GHC.Prim.RealWorld,
                                                                                                                            Ptr
                                                                                                                              Word8 #))))
                                                                                                       eta6_Xn
                                                                                                of
                                                                                                { (# ipv3_Xu,
                                                                                                     ipv4_Xv #) ->
                                                                                                jump $wgo_Xk
                                                                                                  (GHC.Prim.+#
                                                                                                     ww1_Xl
                                                                                                     1#)
                                                                                                  ipv4_Xv
                                                                                                  ipv3_Xu
                                                                                                }
                                                                                            }
                                                                                            }
                                                                                        }
                                                                                        }; } in
                                                                                  jump $wgo_Xk
                                                                                    (GHC.Prim.+#
                                                                                       sc2_s29g 1#)
                                                                                    ipv1_a26M
                                                                                    ipv_a26L
                                                                                  }
                                                                              }
                                                                              }
                                                                          }; } in
                                                                    jump $s$wgo_s29j
                                                                      eta5_s28W bx6_Xa ww_s28T } in
                                                              case GHC.Prim.<=# ds4_Xg y1_s27t of {
                                                                __DEFAULT -> jump $j3_s27P y1_s27t;
                                                                1# -> jump $j3_s27P ds4_Xg
                                                              }
                                                          }
                                                          } } in
                                                    case wild3_X6 of {
                                                      __DEFAULT -> jump $j2_Xf;
                                                      -1# ->
                                                        case a1_Xe of {
                                                          __DEFAULT -> jump $j2_Xf;
                                                          -9223372036854775808# ->
                                                            case GHC.Real.overflowError
                                                            of wild7_00 {
                                                            }
                                                        }
                                                    };
                                                  1# ->
                                                    ((k_X2 wild4_X9)
                                                     `cast` (GHC.Types.N:IO[0]
                                                                 <B.BuildSignal r_a238>_R
                                                             :: IO (B.BuildSignal r_a238)
                                                                ~R# (GHC.Prim.State#
                                                                       GHC.Prim.RealWorld
                                                                     -> (# GHC.Prim.State#
                                                                             GHC.Prim.RealWorld,
                                                                           B.BuildSignal
                                                                             r_a238 #))))
                                                      eta5_s28W
                                                }
                                                }; } in
                                        $wouterLoop_s28Y bx1_d22N br_X7 eta4_X8)
                                     `cast` (<B.BufferRange>_R
                                             %<'Many>_N ->_R Sym (GHC.Types.N:IO[0]
                                                                      <B.BuildSignal r_a238>_R)
                                             :: (B.BufferRange
                                                 -> GHC.Prim.State# GHC.Prim.RealWorld
                                                 -> (# GHC.Prim.State# GHC.Prim.RealWorld,
                                                       B.BuildSignal r_a238 #))
                                                ~R# (B.BufferRange
                                                     -> IO (B.BuildSignal r_a238)))) #);
                             1# ->
                               let {
                                 y1_s27t :: GHC.Prim.Int#
                                 [LclId]
                                 y1_s27t = GHC.Prim.-# iend_s27f bx1_d22N } in
                               join {
                                 $j2_s27P [Dmd=1C(1,!P(L,L))]
                                   :: GHC.Prim.Int#
                                      -> (# GHC.Prim.State# GHC.Prim.RealWorld,
                                            B.BuildSignal r_a238 #)
                                 [LclId[JoinId(1)(Nothing)], Arity=1, Str=<L>, Unf=OtherCon []]
                                 $j2_s27P (y_a23f [OS=OneShot] :: GHC.Prim.Int#)
                                   = let {
                                       iendTmp_s27v :: GHC.Prim.Int#
                                       [LclId]
                                       iendTmp_s27v = GHC.Prim.+# bx1_d22N y_a23f } in
                                     join {
                                       exit_Xc [Dmd=LC(S,C(1,C(1,!P(L,L))))]
                                         :: GHC.Prim.Int#
                                            -> GHC.Prim.State# GHC.Prim.RealWorld
                                            -> GHC.Prim.Addr#
                                            -> (# GHC.Prim.State# GHC.Prim.RealWorld,
                                                  B.BuildSignal r_a238 #)
                                       [LclId[JoinId(3)(Nothing)],
                                        Arity=3,
                                        Str=<L><L><L>,
                                        Unf=OtherCon []]
                                       exit_Xc (ww_s28F [OS=OneShot] :: GHC.Prim.Int#)
                                               (eta4_s28I [OS=OneShot]
                                                  :: GHC.Prim.State# GHC.Prim.RealWorld)
                                               (ipv_s24F [OS=OneShot] :: GHC.Prim.Addr#)
                                         = letrec {
                                             $s$wouterLoop_s2bC [Occ=LoopBreaker,
                                                                 Dmd=SC(S,C(1,C(1,C(1,!P(L,L)))))]
                                               :: GHC.Prim.Addr#
                                                  -> GHC.Prim.Addr#
                                                  -> GHC.Prim.Int#
                                                  -> GHC.Prim.State# GHC.Prim.RealWorld
                                                  -> (# GHC.Prim.State# GHC.Prim.RealWorld,
                                                        B.BuildSignal r_a238 #)
                                             [LclId, Arity=4, Str=<L><L><L><L>, Unf=OtherCon []]
                                             $s$wouterLoop_s2bC
                                               = \ (sc_s2bz :: GHC.Prim.Addr#)
                                                   (sc1_s2bA :: GHC.Prim.Addr#)
                                                   (sc2_s2by :: GHC.Prim.Int#)
                                                   (eta5_s28W [OS=OneShot]
                                                      :: GHC.Prim.State# GHC.Prim.RealWorld) ->
                                                   case GHC.Prim.>=# sc2_s2by iend_s27f of {
                                                     __DEFAULT ->
                                                       let {
                                                         a1_Xi :: GHC.Prim.Int#
                                                         [LclId]
                                                         a1_Xi
                                                           = GHC.Prim.minusAddr#
                                                               sc1_s2bA sc_s2bz } in
                                                       join {
                                                         $j3_Xj [Dmd=1!P(L,L)]
                                                           :: (# GHC.Prim.State# GHC.Prim.RealWorld,
                                                                 B.BuildSignal r_a238 #)
                                                         [LclId[JoinId(0)(Nothing)]]
                                                         $j3_Xj
                                                           = case GHC.Prim.quotInt# a1_Xi wild3_X6
                                                             of ds4_Xk
                                                             { __DEFAULT ->
                                                             case GHC.Prim.># ds4_Xk 0# of {
                                                               __DEFAULT ->
                                                                 (# eta5_s28W,
                                                                    Data.ByteString.Builder.Internal.BufferFull
                                                                      @r_a238
                                                                      wild3_X6
                                                                      sc_s2bz
                                                                      ((\ (br_X7 :: B.BufferRange)
                                                                          (eta6_X8 [OS=OneShot]
                                                                             :: GHC.Prim.State#
                                                                                  GHC.Prim.RealWorld) ->
                                                                          $wouterLoop_s28Y
                                                                            sc2_s2by br_X7 eta6_X8)
                                                                       `cast` (<B.BufferRange>_R
                                                                               %<'Many>_N ->_R Sym (GHC.Types.N:IO[0]
                                                                                                        <B.BuildSignal
                                                                                                           r_a238>_R)
                                                                               :: (B.BufferRange
                                                                                   -> GHC.Prim.State#
                                                                                        GHC.Prim.RealWorld
                                                                                   -> (# GHC.Prim.State#
                                                                                           GHC.Prim.RealWorld,
                                                                                         B.BuildSignal
                                                                                           r_a238 #))
                                                                                  ~R# (B.BufferRange
                                                                                       -> IO
                                                                                            (B.BuildSignal
                                                                                               r_a238)))) #);
                                                               1# ->
                                                                 let {
                                                                   y2_Xm :: GHC.Prim.Int#
                                                                   [LclId]
                                                                   y2_Xm
                                                                     = GHC.Prim.-#
                                                                         iend_s27f sc2_s2by } in
                                                                 join {
                                                                   $j4_Xn [Dmd=1C(1,!P(L,L))]
                                                                     :: GHC.Prim.Int#
                                                                        -> (# GHC.Prim.State#
                                                                                GHC.Prim.RealWorld,
                                                                              B.BuildSignal
                                                                                r_a238 #)
                                                                   [LclId[JoinId(1)(Nothing)],
                                                                    Arity=1,
                                                                    Str=<L>,
                                                                    Unf=OtherCon []]
                                                                   $j4_Xn (y3_Xo [OS=OneShot]
                                                                             :: GHC.Prim.Int#)
                                                                     = let {
                                                                         iendTmp1_Xp
                                                                           :: GHC.Prim.Int#
                                                                         [LclId]
                                                                         iendTmp1_Xp
                                                                           = GHC.Prim.+#
                                                                               sc2_s2by y3_Xo } in
                                                                       joinrec {
                                                                         $s$wgo_s2bW [Occ=LoopBreaker,
                                                                                      Dmd=SC(S,C(1,C(1,!P(L,L))))]
                                                                           :: GHC.Prim.State#
                                                                                GHC.Prim.RealWorld
                                                                              -> GHC.Prim.Addr#
                                                                              -> GHC.Prim.Int#
                                                                              -> (# GHC.Prim.State#
                                                                                      GHC.Prim.RealWorld,
                                                                                    B.BuildSignal
                                                                                      r_a238 #)
                                                                         [LclId[JoinId(3)(Nothing)],
                                                                          Arity=3,
                                                                          Str=<L><L><L>,
                                                                          Unf=OtherCon []]
                                                                         $s$wgo_s2bW (sc3_s2bV
                                                                                        :: GHC.Prim.State#
                                                                                             GHC.Prim.RealWorld)
                                                                                     (sc4_s2bU
                                                                                        :: GHC.Prim.Addr#)
                                                                                     (sc5_s2bT
                                                                                        :: GHC.Prim.Int#)
                                                                           = case GHC.Prim.<#
                                                                                    sc5_s2bT
                                                                                    iendTmp1_Xp
                                                                             of {
                                                                               __DEFAULT ->
                                                                                 $s$wouterLoop_s2bC
                                                                                   sc4_s2bU
                                                                                   sc1_s2bA
                                                                                   sc5_s2bT
                                                                                   sc3_s2bV;
                                                                               1# ->
                                                                                 case GHC.Prim.indexWord8Array#
                                                                                        bx_d22M
                                                                                        sc5_s2bT
                                                                                 of r#_a24P
                                                                                 { __DEFAULT ->
                                                                                 case GHC.Prim.ltWord8#
                                                                                        r#_a24P
                                                                                        128#Word8
                                                                                 of {
                                                                                   __DEFAULT ->
                                                                                     case GHC.Prim.writeWord8OffAddr#
                                                                                            @GHC.Prim.RealWorld
                                                                                            sc4_s2bU
                                                                                            0#
                                                                                            r#_a24P
                                                                                            sc3_s2bV
                                                                                     of s2_a26u
                                                                                     { __DEFAULT ->
                                                                                     jump $s$wgo_s2bW
                                                                                       s2_a26u
                                                                                       (GHC.Prim.plusAddr#
                                                                                          sc4_s2bU
                                                                                          1#)
                                                                                       (GHC.Prim.+#
                                                                                          sc5_s2bT
                                                                                          1#)
                                                                                     };
                                                                                   1# ->
                                                                                     case ((ds1_a27N
                                                                                              (GHC.Word.W8#
                                                                                                 r#_a24P)
                                                                                              (GHC.Ptr.Ptr
                                                                                                 @Word8
                                                                                                 sc4_s2bU))
                                                                                           `cast` (GHC.Types.N:IO[0]
                                                                                                       <Ptr
                                                                                                          Word8>_R
                                                                                                   :: IO
                                                                                                        (Ptr
                                                                                                           Word8)
                                                                                                      ~R# (GHC.Prim.State#
                                                                                                             GHC.Prim.RealWorld
                                                                                                           -> (# GHC.Prim.State#
                                                                                                                   GHC.Prim.RealWorld,
                                                                                                                 Ptr
                                                                                                                   Word8 #))))
                                                                                            sc3_s2bV
                                                                                     of
                                                                                     { (# ipv1_a26L,
                                                                                          ipv2_a26M #) ->
                                                                                     joinrec {
                                                                                       $wgo_Xu [InlPrag=[2],
                                                                                                Occ=LoopBreaker,
                                                                                                Dmd=SC(S,C(1,C(1,!P(L,L))))]
                                                                                         :: GHC.Prim.Int#
                                                                                            -> Ptr
                                                                                                 Word8
                                                                                            -> GHC.Prim.State#
                                                                                                 GHC.Prim.RealWorld
                                                                                            -> (# GHC.Prim.State#
                                                                                                    GHC.Prim.RealWorld,
                                                                                                  B.BuildSignal
                                                                                                    r_a238 #)
                                                                                       [LclId[JoinId(3)(Just [~,
                                                                                                              !])],
                                                                                        Arity=3,
                                                                                        Str=<L><1L><L>,
                                                                                        Unf=OtherCon []]
                                                                                       $wgo_Xu (ww1_Xv
                                                                                                  :: GHC.Prim.Int#)
                                                                                               (op_Xw
                                                                                                  :: Ptr
                                                                                                       Word8)
                                                                                               (eta6_Xx [OS=OneShot]
                                                                                                  :: GHC.Prim.State#
                                                                                                       GHC.Prim.RealWorld)
                                                                                         = case op_Xw
                                                                                           of op1_Xy
                                                                                           { GHC.Ptr.Ptr ipv3_Xz ->
                                                                                           case GHC.Prim.<#
                                                                                                  ww1_Xv
                                                                                                  iendTmp1_Xp
                                                                                           of {
                                                                                             __DEFAULT ->
                                                                                               $s$wouterLoop_s2bC
                                                                                                 ipv3_Xz
                                                                                                 sc1_s2bA
                                                                                                 ww1_Xv
                                                                                                 eta6_Xx;
                                                                                             1# ->
                                                                                               case GHC.Prim.indexWord8Array#
                                                                                                      bx_d22M
                                                                                                      ww1_Xv
                                                                                               of r#1_XB
                                                                                               { __DEFAULT ->
                                                                                               case GHC.Prim.ltWord8#
                                                                                                      r#1_XB
                                                                                                      128#Word8
                                                                                               of {
                                                                                                 __DEFAULT ->
                                                                                                   case GHC.Prim.writeWord8OffAddr#
                                                                                                          @GHC.Prim.RealWorld
                                                                                                          ipv3_Xz
                                                                                                          0#
                                                                                                          r#1_XB
                                                                                                          eta6_Xx
                                                                                                   of s2_a26u
                                                                                                   { __DEFAULT ->
                                                                                                   jump $wgo_Xu
                                                                                                     (GHC.Prim.+#
                                                                                                        ww1_Xv
                                                                                                        1#)
                                                                                                     (GHC.Ptr.Ptr
                                                                                                        @Word8
                                                                                                        (GHC.Prim.plusAddr#
                                                                                                           ipv3_Xz
                                                                                                           1#))
                                                                                                     s2_a26u
                                                                                                   };
                                                                                                 1# ->
                                                                                                   case ((ds1_a27N
                                                                                                            (GHC.Word.W8#
                                                                                                               r#1_XB)
                                                                                                            op1_Xy)
                                                                                                         `cast` (GHC.Types.N:IO[0]
                                                                                                                     <Ptr
                                                                                                                        Word8>_R
                                                                                                                 :: IO
                                                                                                                      (Ptr
                                                                                                                         Word8)
                                                                                                                    ~R# (GHC.Prim.State#
                                                                                                                           GHC.Prim.RealWorld
                                                                                                                         -> (# GHC.Prim.State#
                                                                                                                                 GHC.Prim.RealWorld,
                                                                                                                               Ptr
                                                                                                                                 Word8 #))))
                                                                                                          eta6_Xx
                                                                                                   of
                                                                                                   { (# ipv4_XE,
                                                                                                        ipv5_XF #) ->
                                                                                                   jump $wgo_Xu
                                                                                                     (GHC.Prim.+#
                                                                                                        ww1_Xv
                                                                                                        1#)
                                                                                                     ipv5_XF
                                                                                                     ipv4_XE
                                                                                                   }
                                                                                               }
                                                                                               }
                                                                                           }
                                                                                           }; } in
                                                                                     jump $wgo_Xu
                                                                                       (GHC.Prim.+#
                                                                                          sc5_s2bT
                                                                                          1#)
                                                                                       ipv2_a26M
                                                                                       ipv1_a26L
                                                                                     }
                                                                                 }
                                                                                 }
                                                                             }; } in
                                                                       jump $s$wgo_s2bW
                                                                         eta5_s28W
                                                                         sc_s2bz
                                                                         sc2_s2by } in
                                                                 case GHC.Prim.<=# ds4_Xk y2_Xm of {
                                                                   __DEFAULT -> jump $j4_Xn y2_Xm;
                                                                   1# -> jump $j4_Xn ds4_Xk
                                                                 }
                                                             }
                                                             } } in
                                                       case wild3_X6 of {
                                                         __DEFAULT -> jump $j3_Xj;
                                                         -1# ->
                                                           case a1_Xi of {
                                                             __DEFAULT -> jump $j3_Xj;
                                                             -9223372036854775808# ->
                                                               case GHC.Real.overflowError
                                                               of wild6_00 {
                                                               }
                                                           }
                                                       };
                                                     1# ->
                                                       ((k_X2
                                                           (Data.ByteString.Builder.Internal.BufferRange
                                                              sc_s2bz sc1_s2bA))
                                                        `cast` (GHC.Types.N:IO[0]
                                                                    <B.BuildSignal r_a238>_R
                                                                :: IO (B.BuildSignal r_a238)
                                                                   ~R# (GHC.Prim.State#
                                                                          GHC.Prim.RealWorld
                                                                        -> (# GHC.Prim.State#
                                                                                GHC.Prim.RealWorld,
                                                                              B.BuildSignal
                                                                                r_a238 #))))
                                                         eta5_s28W
                                                   };
                                             $wouterLoop_s28Y [InlPrag=[2],
                                                               Occ=LoopBreaker,
                                                               Dmd=LC(S,C(1,C(1,L)))]
                                               :: GHC.Prim.Int#
                                                  -> B.BufferRange
                                                  -> GHC.Prim.State# GHC.Prim.RealWorld
                                                  -> (# GHC.Prim.State# GHC.Prim.RealWorld,
                                                        B.BuildSignal r_a238 #)
                                             [LclId[StrictWorker([~, !])],
                                              Arity=3,
                                              Str=<L><1L><L>,
                                              Unf=OtherCon []]
                                             $wouterLoop_s28Y
                                               = \ (ww1_s28T :: GHC.Prim.Int#)
                                                   (br_s28V :: B.BufferRange)
                                                   (eta5_s28W [OS=OneShot]
                                                      :: GHC.Prim.State# GHC.Prim.RealWorld) ->
                                                   case br_s28V of wild4_Xd
                                                   { B.BufferRange bx6_Xe bx7_Xf ->
                                                   case GHC.Prim.>=# ww1_s28T iend_s27f of {
                                                     __DEFAULT ->
                                                       let {
                                                         a1_Xi :: GHC.Prim.Int#
                                                         [LclId]
                                                         a1_Xi
                                                           = GHC.Prim.minusAddr# bx7_Xf bx6_Xe } in
                                                       join {
                                                         $j3_Xj [Dmd=1!P(L,L)]
                                                           :: (# GHC.Prim.State# GHC.Prim.RealWorld,
                                                                 B.BuildSignal r_a238 #)
                                                         [LclId[JoinId(0)(Nothing)]]
                                                         $j3_Xj
                                                           = case GHC.Prim.quotInt# a1_Xi wild3_X6
                                                             of ds4_Xk
                                                             { __DEFAULT ->
                                                             case GHC.Prim.># ds4_Xk 0# of {
                                                               __DEFAULT ->
                                                                 (# eta5_s28W,
                                                                    Data.ByteString.Builder.Internal.BufferFull
                                                                      @r_a238
                                                                      wild3_X6
                                                                      bx6_Xe
                                                                      ((\ (br1_X7 :: B.BufferRange)
                                                                          (eta6_X8 [OS=OneShot]
                                                                             :: GHC.Prim.State#
                                                                                  GHC.Prim.RealWorld) ->
                                                                          $wouterLoop_s28Y
                                                                            ww1_s28T br1_X7 eta6_X8)
                                                                       `cast` (<B.BufferRange>_R
                                                                               %<'Many>_N ->_R Sym (GHC.Types.N:IO[0]
                                                                                                        <B.BuildSignal
                                                                                                           r_a238>_R)
                                                                               :: (B.BufferRange
                                                                                   -> GHC.Prim.State#
                                                                                        GHC.Prim.RealWorld
                                                                                   -> (# GHC.Prim.State#
                                                                                           GHC.Prim.RealWorld,
                                                                                         B.BuildSignal
                                                                                           r_a238 #))
                                                                                  ~R# (B.BufferRange
                                                                                       -> IO
                                                                                            (B.BuildSignal
                                                                                               r_a238)))) #);
                                                               1# ->
                                                                 let {
                                                                   y2_Xm :: GHC.Prim.Int#
                                                                   [LclId]
                                                                   y2_Xm
                                                                     = GHC.Prim.-#
                                                                         iend_s27f ww1_s28T } in
                                                                 join {
                                                                   $j4_Xn [Dmd=1C(1,!P(L,L))]
                                                                     :: GHC.Prim.Int#
                                                                        -> (# GHC.Prim.State#
                                                                                GHC.Prim.RealWorld,
                                                                              B.BuildSignal
                                                                                r_a238 #)
                                                                   [LclId[JoinId(1)(Nothing)],
                                                                    Arity=1,
                                                                    Str=<L>,
                                                                    Unf=OtherCon []]
                                                                   $j4_Xn (y3_Xo [OS=OneShot]
                                                                             :: GHC.Prim.Int#)
                                                                     = let {
                                                                         iendTmp1_Xp
                                                                           :: GHC.Prim.Int#
                                                                         [LclId]
                                                                         iendTmp1_Xp
                                                                           = GHC.Prim.+#
                                                                               ww1_s28T y3_Xo } in
                                                                       joinrec {
                                                                         $s$wgo_s2b3 [Occ=LoopBreaker,
                                                                                      Dmd=SC(S,C(1,C(1,!P(L,L))))]
                                                                           :: GHC.Prim.State#
                                                                                GHC.Prim.RealWorld
                                                                              -> GHC.Prim.Addr#
                                                                              -> GHC.Prim.Int#
                                                                              -> (# GHC.Prim.State#
                                                                                      GHC.Prim.RealWorld,
                                                                                    B.BuildSignal
                                                                                      r_a238 #)
                                                                         [LclId[JoinId(3)(Nothing)],
                                                                          Arity=3,
                                                                          Str=<L><L><L>,
                                                                          Unf=OtherCon []]
                                                                         $s$wgo_s2b3 (sc_s2b2
                                                                                        :: GHC.Prim.State#
                                                                                             GHC.Prim.RealWorld)
                                                                                     (sc1_s2b1
                                                                                        :: GHC.Prim.Addr#)
                                                                                     (sc2_s2b0
                                                                                        :: GHC.Prim.Int#)
                                                                           = case GHC.Prim.<#
                                                                                    sc2_s2b0
                                                                                    iendTmp1_Xp
                                                                             of {
                                                                               __DEFAULT ->
                                                                                 $s$wouterLoop_s2bC
                                                                                   sc1_s2b1
                                                                                   bx7_Xf
                                                                                   sc2_s2b0
                                                                                   sc_s2b2;
                                                                               1# ->
                                                                                 case GHC.Prim.indexWord8Array#
                                                                                        bx_d22M
                                                                                        sc2_s2b0
                                                                                 of r#_a24P
                                                                                 { __DEFAULT ->
                                                                                 case GHC.Prim.ltWord8#
                                                                                        r#_a24P
                                                                                        128#Word8
                                                                                 of {
                                                                                   __DEFAULT ->
                                                                                     case GHC.Prim.writeWord8OffAddr#
                                                                                            @GHC.Prim.RealWorld
                                                                                            sc1_s2b1
                                                                                            0#
                                                                                            r#_a24P
                                                                                            sc_s2b2
                                                                                     of s2_a26u
                                                                                     { __DEFAULT ->
                                                                                     jump $s$wgo_s2b3
                                                                                       s2_a26u
                                                                                       (GHC.Prim.plusAddr#
                                                                                          sc1_s2b1
                                                                                          1#)
                                                                                       (GHC.Prim.+#
                                                                                          sc2_s2b0
                                                                                          1#)
                                                                                     };
                                                                                   1# ->
                                                                                     case ((ds1_a27N
                                                                                              (GHC.Word.W8#
                                                                                                 r#_a24P)
                                                                                              (GHC.Ptr.Ptr
                                                                                                 @Word8
                                                                                                 sc1_s2b1))
                                                                                           `cast` (GHC.Types.N:IO[0]
                                                                                                       <Ptr
                                                                                                          Word8>_R
                                                                                                   :: IO
                                                                                                        (Ptr
                                                                                                           Word8)
                                                                                                      ~R# (GHC.Prim.State#
                                                                                                             GHC.Prim.RealWorld
                                                                                                           -> (# GHC.Prim.State#
                                                                                                                   GHC.Prim.RealWorld,
                                                                                                                 Ptr
                                                                                                                   Word8 #))))
                                                                                            sc_s2b2
                                                                                     of
                                                                                     { (# ipv1_a26L,
                                                                                          ipv2_a26M #) ->
                                                                                     joinrec {
                                                                                       $s$wgo1_s2bd [Occ=LoopBreaker,
                                                                                                     Dmd=LC(S,C(1,C(1,!P(L,L))))]
                                                                                         :: GHC.Prim.State#
                                                                                              GHC.Prim.RealWorld
                                                                                            -> GHC.Prim.Addr#
                                                                                            -> GHC.Prim.Int#
                                                                                            -> (# GHC.Prim.State#
                                                                                                    GHC.Prim.RealWorld,
                                                                                                  B.BuildSignal
                                                                                                    r_a238 #)
                                                                                       [LclId[JoinId(3)(Nothing)],
                                                                                        Arity=3,
                                                                                        Str=<L><L><L>,
                                                                                        Unf=OtherCon []]
                                                                                       $s$wgo1_s2bd (sc3_s2b9
                                                                                                       :: GHC.Prim.State#
                                                                                                            GHC.Prim.RealWorld)
                                                                                                    (sc4_s2b8
                                                                                                       :: GHC.Prim.Addr#)
                                                                                                    (sc5_s2b7
                                                                                                       :: GHC.Prim.Int#)
                                                                                         = case GHC.Prim.<#
                                                                                                  sc5_s2b7
                                                                                                  iendTmp1_Xp
                                                                                           of {
                                                                                             __DEFAULT ->
                                                                                               $s$wouterLoop_s2bC
                                                                                                 sc4_s2b8
                                                                                                 bx7_Xf
                                                                                                 sc5_s2b7
                                                                                                 sc3_s2b9;
                                                                                             1# ->
                                                                                               case GHC.Prim.indexWord8Array#
                                                                                                      bx_d22M
                                                                                                      sc5_s2b7
                                                                                               of r#1_XB
                                                                                               { __DEFAULT ->
                                                                                               case GHC.Prim.ltWord8#
                                                                                                      r#1_XB
                                                                                                      128#Word8
                                                                                               of {
                                                                                                 __DEFAULT ->
                                                                                                   case GHC.Prim.writeWord8OffAddr#
                                                                                                          @GHC.Prim.RealWorld
                                                                                                          sc4_s2b8
                                                                                                          0#
                                                                                                          r#1_XB
                                                                                                          sc3_s2b9
                                                                                                   of s2_a26u
                                                                                                   { __DEFAULT ->
                                                                                                   jump $s$wgo1_s2bd
                                                                                                     s2_a26u
                                                                                                     (GHC.Prim.plusAddr#
                                                                                                        sc4_s2b8
                                                                                                        1#)
                                                                                                     (GHC.Prim.+#
                                                                                                        sc5_s2b7
                                                                                                        1#)
                                                                                                   };
                                                                                                 1# ->
                                                                                                   case ((ds1_a27N
                                                                                                            (GHC.Word.W8#
                                                                                                               r#1_XB)
                                                                                                            (GHC.Ptr.Ptr
                                                                                                               @Word8
                                                                                                               sc4_s2b8))
                                                                                                         `cast` (GHC.Types.N:IO[0]
                                                                                                                     <Ptr
                                                                                                                        Word8>_R
                                                                                                                 :: IO
                                                                                                                      (Ptr
                                                                                                                         Word8)
                                                                                                                    ~R# (GHC.Prim.State#
                                                                                                                           GHC.Prim.RealWorld
                                                                                                                         -> (# GHC.Prim.State#
                                                                                                                                 GHC.Prim.RealWorld,
                                                                                                                               Ptr
                                                                                                                                 Word8 #))))
                                                                                                          sc3_s2b9
                                                                                                   of
                                                                                                   { (# ipv3_XE,
                                                                                                        ipv4_XF #) ->
                                                                                                   jump $wgo_Xu
                                                                                                     (GHC.Prim.+#
                                                                                                        sc5_s2b7
                                                                                                        1#)
                                                                                                     ipv4_XF
                                                                                                     ipv3_XE
                                                                                                   }
                                                                                               }
                                                                                               }
                                                                                           };
                                                                                       $wgo_Xu [InlPrag=[2],
                                                                                                Occ=LoopBreaker,
                                                                                                Dmd=SC(S,C(1,C(1,!P(L,L))))]
                                                                                         :: GHC.Prim.Int#
                                                                                            -> Ptr
                                                                                                 Word8
                                                                                            -> GHC.Prim.State#
                                                                                                 GHC.Prim.RealWorld
                                                                                            -> (# GHC.Prim.State#
                                                                                                    GHC.Prim.RealWorld,
                                                                                                  B.BuildSignal
                                                                                                    r_a238 #)
                                                                                       [LclId[JoinId(3)(Just [~,
                                                                                                              !])],
                                                                                        Arity=3,
                                                                                        Str=<L><1L><L>,
                                                                                        Unf=OtherCon []]
                                                                                       $wgo_Xu (ww2_Xv
                                                                                                  :: GHC.Prim.Int#)
                                                                                               (op_Xw
                                                                                                  :: Ptr
                                                                                                       Word8)
                                                                                               (eta6_Xx [OS=OneShot]
                                                                                                  :: GHC.Prim.State#
                                                                                                       GHC.Prim.RealWorld)
                                                                                         = case op_Xw
                                                                                           of op1_Xy
                                                                                           { GHC.Ptr.Ptr ipv3_Xz ->
                                                                                           case GHC.Prim.<#
                                                                                                  ww2_Xv
                                                                                                  iendTmp1_Xp
                                                                                           of {
                                                                                             __DEFAULT ->
                                                                                               $s$wouterLoop_s2bC
                                                                                                 ipv3_Xz
                                                                                                 bx7_Xf
                                                                                                 ww2_Xv
                                                                                                 eta6_Xx;
                                                                                             1# ->
                                                                                               case GHC.Prim.indexWord8Array#
                                                                                                      bx_d22M
                                                                                                      ww2_Xv
                                                                                               of r#1_XB
                                                                                               { __DEFAULT ->
                                                                                               case GHC.Prim.ltWord8#
                                                                                                      r#1_XB
                                                                                                      128#Word8
                                                                                               of {
                                                                                                 __DEFAULT ->
                                                                                                   case GHC.Prim.writeWord8OffAddr#
                                                                                                          @GHC.Prim.RealWorld
                                                                                                          ipv3_Xz
                                                                                                          0#
                                                                                                          r#1_XB
                                                                                                          eta6_Xx
                                                                                                   of s2_a26u
                                                                                                   { __DEFAULT ->
                                                                                                   jump $s$wgo1_s2bd
                                                                                                     s2_a26u
                                                                                                     (GHC.Prim.plusAddr#
                                                                                                        ipv3_Xz
                                                                                                        1#)
                                                                                                     (GHC.Prim.+#
                                                                                                        ww2_Xv
                                                                                                        1#)
                                                                                                   };
                                                                                                 1# ->
                                                                                                   case ((ds1_a27N
                                                                                                            (GHC.Word.W8#
                                                                                                               r#1_XB)
                                                                                                            op1_Xy)
                                                                                                         `cast` (GHC.Types.N:IO[0]
                                                                                                                     <Ptr
                                                                                                                        Word8>_R
                                                                                                                 :: IO
                                                                                                                      (Ptr
                                                                                                                         Word8)
                                                                                                                    ~R# (GHC.Prim.State#
                                                                                                                           GHC.Prim.RealWorld
                                                                                                                         -> (# GHC.Prim.State#
                                                                                                                                 GHC.Prim.RealWorld,
                                                                                                                               Ptr
                                                                                                                                 Word8 #))))
                                                                                                          eta6_Xx
                                                                                                   of
                                                                                                   { (# ipv4_XE,
                                                                                                        ipv5_XF #) ->
                                                                                                   jump $wgo_Xu
                                                                                                     (GHC.Prim.+#
                                                                                                        ww2_Xv
                                                                                                        1#)
                                                                                                     ipv5_XF
                                                                                                     ipv4_XE
                                                                                                   }
                                                                                               }
                                                                                               }
                                                                                           }
                                                                                           }; } in
                                                                                     jump $wgo_Xu
                                                                                       (GHC.Prim.+#
                                                                                          sc2_s2b0
                                                                                          1#)
                                                                                       ipv2_a26M
                                                                                       ipv1_a26L
                                                                                     }
                                                                                 }
                                                                                 }
                                                                             }; } in
                                                                       jump $s$wgo_s2b3
                                                                         eta5_s28W
                                                                         bx6_Xe
                                                                         ww1_s28T } in
                                                                 case GHC.Prim.<=# ds4_Xk y2_Xm of {
                                                                   __DEFAULT -> jump $j4_Xn y2_Xm;
                                                                   1# -> jump $j4_Xn ds4_Xk
                                                                 }
                                                             }
                                                             } } in
                                                       case wild3_X6 of {
                                                         __DEFAULT -> jump $j3_Xj;
                                                         -1# ->
                                                           case a1_Xi of {
                                                             __DEFAULT -> jump $j3_Xj;
                                                             -9223372036854775808# ->
                                                               case GHC.Real.overflowError
                                                               of wild7_00 {
                                                               }
                                                           }
                                                       };
                                                     1# ->
                                                       ((k_X2 wild4_Xd)
                                                        `cast` (GHC.Types.N:IO[0]
                                                                    <B.BuildSignal r_a238>_R
                                                                :: IO (B.BuildSignal r_a238)
                                                                   ~R# (GHC.Prim.State#
                                                                          GHC.Prim.RealWorld
                                                                        -> (# GHC.Prim.State#
                                                                                GHC.Prim.RealWorld,
                                                                              B.BuildSignal
                                                                                r_a238 #))))
                                                         eta5_s28W
                                                   }
                                                   }; } in
                                           $s$wouterLoop_s2bC
                                             ipv_s24F bx4_d22Q ww_s28F eta4_s28I } in
                                     joinrec {
                                       $s$wgo_s2cO [Occ=LoopBreaker, Dmd=SC(S,C(1,C(1,!P(L,L))))]
                                         :: GHC.Prim.State# GHC.Prim.RealWorld
                                            -> GHC.Prim.Addr#
                                            -> GHC.Prim.Int#
                                            -> (# GHC.Prim.State# GHC.Prim.RealWorld,
                                                  B.BuildSignal r_a238 #)
                                       [LclId[JoinId(3)(Nothing)],
                                        Arity=3,
                                        Str=<L><L><L>,
                                        Unf=OtherCon []]
                                       $s$wgo_s2cO (sc_s2cN :: GHC.Prim.State# GHC.Prim.RealWorld)
                                                   (sc1_s2cM :: GHC.Prim.Addr#)
                                                   (sc2_s2cL :: GHC.Prim.Int#)
                                         = case GHC.Prim.<# sc2_s2cL iendTmp_s27v of {
                                             __DEFAULT -> jump exit_Xc sc2_s2cL sc_s2cN sc1_s2cM;
                                             1# ->
                                               case GHC.Prim.indexWord8Array# bx_d22M sc2_s2cL
                                               of r#_a24P
                                               { __DEFAULT ->
                                               case GHC.Prim.ltWord8# r#_a24P 128#Word8 of {
                                                 __DEFAULT ->
                                                   case GHC.Prim.writeWord8OffAddr#
                                                          @GHC.Prim.RealWorld
                                                          sc1_s2cM
                                                          0#
                                                          r#_a24P
                                                          sc_s2cN
                                                   of s2_a26u
                                                   { __DEFAULT ->
                                                   jump $s$wgo_s2cO
                                                     s2_a26u
                                                     (GHC.Prim.plusAddr# sc1_s2cM 1#)
                                                     (GHC.Prim.+# sc2_s2cL 1#)
                                                   };
                                                 1# ->
                                                   case ((ds1_a27N
                                                            (GHC.Word.W8# r#_a24P)
                                                            (GHC.Ptr.Ptr @Word8 sc1_s2cM))
                                                         `cast` (GHC.Types.N:IO[0] <Ptr Word8>_R
                                                                 :: IO (Ptr Word8)
                                                                    ~R# (GHC.Prim.State#
                                                                           GHC.Prim.RealWorld
                                                                         -> (# GHC.Prim.State#
                                                                                 GHC.Prim.RealWorld,
                                                                               Ptr Word8 #))))
                                                          sc_s2cN
                                                   of
                                                   { (# ipv_a26L, ipv1_a26M #) ->
                                                   joinrec {
                                                     $s$wgo1_s2cY [Occ=LoopBreaker,
                                                                   Dmd=LC(S,C(1,C(1,!P(L,L))))]
                                                       :: GHC.Prim.State# GHC.Prim.RealWorld
                                                          -> GHC.Prim.Addr#
                                                          -> GHC.Prim.Int#
                                                          -> (# GHC.Prim.State# GHC.Prim.RealWorld,
                                                                B.BuildSignal r_a238 #)
                                                     [LclId[JoinId(3)(Nothing)],
                                                      Arity=3,
                                                      Str=<L><L><L>,
                                                      Unf=OtherCon []]
                                                     $s$wgo1_s2cY (sc3_s2cU
                                                                     :: GHC.Prim.State#
                                                                          GHC.Prim.RealWorld)
                                                                  (sc4_s2cT :: GHC.Prim.Addr#)
                                                                  (sc5_s2cS :: GHC.Prim.Int#)
                                                       = case GHC.Prim.<# sc5_s2cS iendTmp_s27v of {
                                                           __DEFAULT ->
                                                             jump exit_Xc
                                                               sc5_s2cS sc3_s2cU sc4_s2cT;
                                                           1# ->
                                                             case GHC.Prim.indexWord8Array#
                                                                    bx_d22M sc5_s2cS
                                                             of r#1_Xk
                                                             { __DEFAULT ->
                                                             case GHC.Prim.ltWord8# r#1_Xk 128#Word8
                                                             of {
                                                               __DEFAULT ->
                                                                 case GHC.Prim.writeWord8OffAddr#
                                                                        @GHC.Prim.RealWorld
                                                                        sc4_s2cT
                                                                        0#
                                                                        r#1_Xk
                                                                        sc3_s2cU
                                                                 of s2_a26u
                                                                 { __DEFAULT ->
                                                                 jump $s$wgo1_s2cY
                                                                   s2_a26u
                                                                   (GHC.Prim.plusAddr# sc4_s2cT 1#)
                                                                   (GHC.Prim.+# sc5_s2cS 1#)
                                                                 };
                                                               1# ->
                                                                 case ((ds1_a27N
                                                                          (GHC.Word.W8# r#1_Xk)
                                                                          (GHC.Ptr.Ptr
                                                                             @Word8 sc4_s2cT))
                                                                       `cast` (GHC.Types.N:IO[0]
                                                                                   <Ptr Word8>_R
                                                                               :: IO (Ptr Word8)
                                                                                  ~R# (GHC.Prim.State#
                                                                                         GHC.Prim.RealWorld
                                                                                       -> (# GHC.Prim.State#
                                                                                               GHC.Prim.RealWorld,
                                                                                             Ptr
                                                                                               Word8 #))))
                                                                        sc3_s2cU
                                                                 of
                                                                 { (# ipv2_Xn, ipv3_Xo #) ->
                                                                 jump $wgo_Xd
                                                                   (GHC.Prim.+# sc5_s2cS 1#)
                                                                   ipv3_Xo
                                                                   ipv2_Xn
                                                                 }
                                                             }
                                                             }
                                                         };
                                                     $wgo_Xd [InlPrag=[2],
                                                              Occ=LoopBreaker,
                                                              Dmd=SC(S,C(1,C(1,!P(L,L))))]
                                                       :: GHC.Prim.Int#
                                                          -> Ptr Word8
                                                          -> GHC.Prim.State# GHC.Prim.RealWorld
                                                          -> (# GHC.Prim.State# GHC.Prim.RealWorld,
                                                                B.BuildSignal r_a238 #)
                                                     [LclId[JoinId(3)(Just [~, !])],
                                                      Arity=3,
                                                      Str=<L><1L><L>,
                                                      Unf=OtherCon []]
                                                     $wgo_Xd (ww_Xe :: GHC.Prim.Int#)
                                                             (op_Xf :: Ptr Word8)
                                                             (eta4_Xg [OS=OneShot]
                                                                :: GHC.Prim.State#
                                                                     GHC.Prim.RealWorld)
                                                       = case op_Xf of op1_Xh
                                                         { GHC.Ptr.Ptr ipv2_Xi ->
                                                         case GHC.Prim.<# ww_Xe iendTmp_s27v of {
                                                           __DEFAULT ->
                                                             jump exit_Xc ww_Xe eta4_Xg ipv2_Xi;
                                                           1# ->
                                                             case GHC.Prim.indexWord8Array#
                                                                    bx_d22M ww_Xe
                                                             of r#1_Xk
                                                             { __DEFAULT ->
                                                             case GHC.Prim.ltWord8# r#1_Xk 128#Word8
                                                             of {
                                                               __DEFAULT ->
                                                                 case GHC.Prim.writeWord8OffAddr#
                                                                        @GHC.Prim.RealWorld
                                                                        ipv2_Xi
                                                                        0#
                                                                        r#1_Xk
                                                                        eta4_Xg
                                                                 of s2_a26u
                                                                 { __DEFAULT ->
                                                                 jump $s$wgo1_s2cY
                                                                   s2_a26u
                                                                   (GHC.Prim.plusAddr# ipv2_Xi 1#)
                                                                   (GHC.Prim.+# ww_Xe 1#)
                                                                 };
                                                               1# ->
                                                                 case ((ds1_a27N
                                                                          (GHC.Word.W8# r#1_Xk)
                                                                          op1_Xh)
                                                                       `cast` (GHC.Types.N:IO[0]
                                                                                   <Ptr Word8>_R
                                                                               :: IO (Ptr Word8)
                                                                                  ~R# (GHC.Prim.State#
                                                                                         GHC.Prim.RealWorld
                                                                                       -> (# GHC.Prim.State#
                                                                                               GHC.Prim.RealWorld,
                                                                                             Ptr
                                                                                               Word8 #))))
                                                                        eta4_Xg
                                                                 of
                                                                 { (# ipv3_Xn, ipv4_Xo #) ->
                                                                 jump $wgo_Xd
                                                                   (GHC.Prim.+# ww_Xe 1#)
                                                                   ipv4_Xo
                                                                   ipv3_Xn
                                                                 }
                                                             }
                                                             }
                                                         }
                                                         }; } in
                                                   jump $wgo_Xd
                                                     (GHC.Prim.+# sc2_s2cL 1#) ipv1_a26M ipv_a26L
                                                   }
                                               }
                                               }
                                           }; } in
                                     jump $s$wgo_s2cO eta3_B3 bx3_d22P bx1_d22N } in
                               case GHC.Prim.<=# ds2_a23R y1_s27t of {
                                 __DEFAULT -> jump $j2_s27P y1_s27t;
                                 1# -> jump $j2_s27P ds2_a23R
                               }
                           }
                           } } in
                     case wild3_X6 of {
                       __DEFAULT -> jump $j1_s27p;
                       -1# ->
                         case a_s27n of {
                           __DEFAULT -> jump $j1_s27p;
                           -9223372036854775808# ->
                             case GHC.Real.overflowError of wild6_00 { }
                         }
                     };
                   0# -> case GHC.Real.divZeroError of wild4_00 { }
                 } } in
           case GHC.Prim.<=# 4# bx5_a27M of {
             __DEFAULT -> jump $j_s28Z 4#;
             1# -> jump $j_s28Z bx5_a27M
           }
           };
         1# ->
           ((k_X2 wild1_X5)
            `cast` (GHC.Types.N:IO[0] <B.BuildSignal r_a238>_R
                    :: IO (B.BuildSignal r_a238)
                       ~R# (GHC.Prim.State# GHC.Prim.RealWorld
                            -> (# GHC.Prim.State# GHC.Prim.RealWorld,
                                  B.BuildSignal r_a238 #))))
             eta3_B3
       }
       }
       }
       })
    `cast` (<BP.BoundedPrim Word8>_R
            %<'Many>_N ->_R <Text>_R
            %<'Many>_N ->_R forall (r :: <*>_N).
                            <B.BuildStep (r |> <*>_N)>_R
                            %<'Many>_N ->_R <B.BufferRange>_R
                            %<'Many>_N ->_R Sym (GHC.Types.N:IO[0]
                                                     <B.BuildSignal (r |> <*>_N)>_R)
                            ; Sym (Data.ByteString.Builder.Internal.N:Builder[0])
            :: (BP.BoundedPrim Word8
                -> Text
                -> forall {r}.
                   B.BuildStep (r |> <*>_N)
                   -> B.BufferRange
                   -> GHC.Prim.State# GHC.Prim.RealWorld
                   -> (# GHC.Prim.State# GHC.Prim.RealWorld,
                         B.BuildSignal (r |> <*>_N) #))
               ~R# (BP.BoundedPrim Word8 -> Text -> B.Builder))

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
Data.Text.Encoding.$trModule4 :: GHC.Prim.Addr#
[GblId,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 20 0}]
Data.Text.Encoding.$trModule4 = "main"#

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
Data.Text.Encoding.$trModule3 :: GHC.Types.TrName
[GblId,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 10 10}]
Data.Text.Encoding.$trModule3
  = GHC.Types.TrNameS Data.Text.Encoding.$trModule4

-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}
Data.Text.Encoding.$trModule2 :: GHC.Prim.Addr#
[GblId,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 60 0}]
Data.Text.Encoding.$trModule2 = "Data.Text.Encoding"#

-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}
Data.Text.Encoding.$trModule1 :: GHC.Types.TrName
[GblId,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 10 10}]
Data.Text.Encoding.$trModule1
  = GHC.Types.TrNameS Data.Text.Encoding.$trModule2

-- RHS size: {terms: 3, types: 0, coercions: 0, joins: 0/0}
Data.Text.Encoding.$trModule :: GHC.Types.Module
[GblId,
 Unf=Unf{Src=<vanilla>, TopLvl=True, Value=True, ConLike=True,
         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 10 10}]
Data.Text.Encoding.$trModule
  = GHC.Types.Module
      Data.Text.Encoding.$trModule3 Data.Text.Encoding.$trModule1




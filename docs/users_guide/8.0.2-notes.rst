.. _release-8-0-2:

Release notes for version 8.0.2
===============================

TODO FIXME

Highlights
----------

-  Many, many bug fixes.

-  A bug has been fixed that caused standalone derived ``Ix`` instances to fail
   for GADTs with exactly one constructor (:ghc-ticket:`12583`).

Full details
------------

Language
~~~~~~~~

-  TODO FIXME.

-  A bug has been fixed that caused derived ``Show`` instances to fail in the
   presence of :ghc-flag:`-XRebindableSyntax` and
   :ghc-flag:`-XOverloadedStrings` (:ghc-ticket:`12688`).

-  Some programs using :ghc-flag:`-XDefaultSignatures` that incorrectly
   type-checked in GHC 8.0.1 are now rejected by GHC 8.0.2. See
   :ghc-ticket:`12784` for details.

Compiler
~~~~~~~~

-  The :ghc-flag:`-Wredundant-constraints` flag has been removed from the
   :ghc-flag:`-Wall` flag set (see :ghc-ticket:`10635`).

-  Added :ghc-flag:`-fdefer-out-of-scope-variables`, which converts variable
   out of scope variables errors into warnings.

-  The RTS :ghc-flag: `-xb` now reads the base heap address in any base,
   defaulting to decimal, hexadecimal if the address starts with `0x`, and
   octal if the address starts with `0`.

-  Due to an oversight in GHC 8.0.1, the value of the preprocessor macro
   ``__GLASGOW_HASKELL_LLVM__``, which exposes the LLVM version used by GHC, was
   no longer an integer. This value is now turned into an integer again, but the
   formatting is changed to be in line with ``__GLASGOW_HASKELL__``
   (:ghc-ticket:`12628`).

Runtime system
~~~~~~~~~~~~~~

- The Runtime linker on Windows is once again recognizing POSIX functions under their
  "deprecated" name. e.g. "strdup" will now be recognizes and internally forwarded to "_strdup".
  If you have existing code already using the correct names (e.g. _strdup) then this will just continue
  to work and no change is needed. For more information about how the forwarding is done please see
  `MSDN <https://msdn.microsoft.com/en-us/library/ms235384.aspx>`_ . This should now introduce the same behavior
  both compiled and interpreted. (see :ghc-ticket:`12497`).

Template Haskell
~~~~~~~~~~~~~~~~

-  TODO FIXME.

- ``addModFinalizer`` now exposes the local typing environment at the splice
  point. This allows ``reify`` to see local and top-level definitions in the
  current declaration group when used as in

  .. code-block:: none

      f x = $(addModFinalizer (reify 'x >>= runIO . print) >> [| x |])

``ghc`` library
~~~~~~~~~~~~~~~

- Accessors are now exposed for ``ErrUtils.ErrMsg`` and ``ErrUtils.ErrDoc``.

- There is now a ``createIservProcessHook`` to allow API users to redirect the
  ``stdout`` and ``stderr`` handles.
